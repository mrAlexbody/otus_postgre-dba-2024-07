# Домашнее задание 05
## Настройка autovacuum с учетом особеностей производительности

### Цель:
* Запустить нагрузочный тест pgbench
* Настроить параметры autovacuum
* Проверить работу autovacuum

#### Описание/Пошаговая инструкция выполнения домашнего задания:
1. Создать **instance ВМ** с **2 ядрами** и **4 Гб ОЗУ** и **SSD 10GB**
2. Установить на него **PostgreSQL 15** с дефолтными настройками
3. Создать БД для тестов: выполнить _**pgbench -i postgres**_
4. Запустить _**pgbench -c8 -P 6 -T 60 -U postgres postgres**_
5. Применить параметры настройки **PostgreSQL** из прикрепленного к материалам занятия файла
6. Протестировать заново
7. Что изменилось и почему?
8. Создать таблицу с текстовым полем и заполнить случайными или сгенерированными данным в размере **1млн строк**
9. Посмотреть размер файла с таблицей
10. **5 раз** обновить все строчки и добавить к каждой строчке любой символ
11. Посмотреть количество мертвых строчек в таблице и когда последний раз приходил автовакуум
12. Подождать некоторое время, проверяя, пришел ли автовакуум
13. **5 раз** обновить все строчки и добавить к каждой строчке любой символ
14. Посмотреть размер файла с таблицей
15. Отключить Автовакуум на конкретной таблице
16. **10 раз** обновить все строчки и добавить к каждой строчке любой символ
17. Посмотреть размер файла с таблицей
18. Объясните полученный результат (
P.S. Не забудьте включить **автовакуум** =)
### Задание со *:
* Написать анонимную процедуру, в которой в цикле 10 раз обновятся все строчки в искомой таблице. 
* Не забыть вывести номер шага цикла.

---
#### Создадим инстанс в _Yandex cloud_ с **2 ядрами** и **4 Гб ОЗУ** и **SSD 10GB**:
```shell

```
### Установим на него PostgreSQL 15 с дефолтными настройками:
```shell

```
#### Создадим БД для тестов:  
```shell
pgbench -i postgres

```
#### Запустим: 
````shell
pgbench -c8 -P 6 -T 60 -U postgres postgres
````
#### Применим параметры настройки PostgreSQL из прикрепленного к материалам занятия файла и протестируем заново:
```shell

```
> Что изменилось и почему?
> > мммм...
#### Создадим таблицу с текстовым полем и заполним случайными данным в размере 1млн строк:
```postgresql

```
#### Посмотрим размер файла с таблицей
```shell

```
#### 5 раз обновим все строчки и добавим к каждой строчке любой символ и посмотрим количество мертвых строчек в таблице и когда последний раз приходил автовакуум:
```postgresql

```
#### Ждем некоторое время и проверяя, прошел ли автовакуум:
```postgresql

```
#### 5 раз обновим все строчки и добавим к каждой строчке любой символ и посмотреть размер файла с таблицей:
```postgresql

```
#### Отключим _Автовакуум_ в таблице:
````postgresql

`````
#### 10 раз обновим все строчки и добавим к каждой строчке любой символ и посмотрим размер файла с таблицей:
```postgresql

```
> - Объясните полученный результат.
>> - Потому-что.... 